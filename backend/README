# ğŸ¼ Projet Symfony avec Docker

Ce projet configure un environnement de dÃ©veloppement Symfony complet avec Docker.

## ğŸš€ Installation rapide

### PrÃ©requis
- Docker
- Docker Compose
- Make (optionnel, pour utiliser les commandes simplifiÃ©es)

### 1. Cloner et configurer le projet

```bash
# CrÃ©er le rÃ©pertoire du projet
mkdir mon-projet-symfony
cd mon-projet-symfony

# CrÃ©er la structure des dossiers
mkdir -p docker/php docker/nginx docker/mysql
```

### 2. Installation automatique avec Make

```bash
# Installation complÃ¨te en une commande
make setup
```

### 3. Installation manuelle (alternative)

```bash
# Construire les images
docker-compose build

# CrÃ©er le projet Symfony
docker-compose run --rm php symfony new . --webapp --no-git

# DÃ©marrer les conteneurs
docker-compose up -d

# Installer les dÃ©pendances
docker-compose exec php composer install
```

## ğŸ“‹ Services disponibles

| Service | URL | Description |
|---------|-----|-------------|
| **Application Symfony** | http://localhost:8080 | Application principale |
| **phpMyAdmin** | http://localhost:8081 | Interface de gestion MySQL |
| **MySQL** | localhost:3306 | Base de donnÃ©es |

### AccÃ¨s Ã  la base de donnÃ©es
- **Host** : localhost (depuis l'host) ou `database` (depuis les conteneurs)
- **Port** : 3306
- **Database** : symfony_db
- **Username** : symfony
- **Password** : symfony

## ğŸ› ï¸ Commandes utiles

### Avec Make (recommandÃ©)
```bash
make help          # Voir toutes les commandes disponibles
make up            # DÃ©marrer les conteneurs
make down          # ArrÃªter les conteneurs
make shell         # AccÃ©der au conteneur PHP
make logs          # Voir les logs
make composer      # Installer les dÃ©pendances
make migrate       # ExÃ©cuter les migrations
make test          # Lancer les tests
make clean         # Nettoyer tout
```

### Commandes Docker classiques
```bash
# DÃ©marrer les services
docker-compose up -d

# ArrÃªter les services
docker-compose down

# Voir les logs
docker-compose logs -f

# AccÃ©der au conteneur PHP
docker-compose exec php bash

# ExÃ©cuter des commandes Symfony
docker-compose exec php php bin/console cache:clear
docker-compose exec php php bin/console doctrine:database:create
docker-compose exec php php bin/console make:controller
```

## ğŸ“ Structure du projet

```
.
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ php/
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â””â”€â”€ php.ini
â”‚   â”œâ”€â”€ nginx/
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â””â”€â”€ default.conf
â”‚   â””â”€â”€ mysql/
â”‚       â””â”€â”€ init.sql
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Makefile
â””â”€â”€ README.md
```

## ğŸ”§ Configuration

### Variables d'environnement

CrÃ©ez un fichier `.env.local` dans votre projet Symfony :

```env
# .env.local
DATABASE_URL="mysql://symfony:symfony@database:3306/symfony_db"
APP_ENV=dev
APP_SECRET=your-secret-key
```

### Personnalisation

- **PHP** : Modifiez `docker/php/php.ini` pour ajuster la configuration PHP
- **Nginx** : Modifiez `docker/nginx/default.conf` pour la configuration web
- **MySQL** : Modifiez `docker/mysql/init.sql` pour l'initialisation de la DB

## ğŸ› DÃ©pannage

### ProblÃ¨me de permissions
```bash
# Corriger les permissions
sudo chown -R $USER:$USER .
```

### Reconstruire les conteneurs
```bash
# Nettoyer et reconstruire
make clean
make build
make up
```

### ProblÃ¨me de ports occupÃ©s
```bash
# VÃ©rifier les ports utilisÃ©s
docker-compose ps
netstat -tulpn | grep :8080
```

Modifiez les ports dans `docker-compose.yml` si nÃ©cessaire.

## ğŸ“Š DÃ©veloppement

### Commandes Symfony courantes

```bash
# CrÃ©er un contrÃ´leur
docker-compose exec php php bin/console make:controller

# CrÃ©er une entitÃ©
docker-compose exec php php bin/console make:entity

# CrÃ©er une migration
docker-compose exec php php bin/console make:migration

# ExÃ©cuter les migrations
docker-compose exec php php bin/console doctrine:migrations:migrate

# Vider le cache
docker-compose exec php php bin/console cache:clear
```

### Assets et Webpack

Si vous utilisez Webpack Encore :

```bash
# Installer les dÃ©pendances Node.js
docker-compose exec node npm install

# Compiler les assets
docker-compose exec node npm run build

# Mode watch pour le dÃ©veloppement
docker-compose exec node npm run watch
```

## ğŸš€ Production

Pour la production, modifiez :

1. **docker-compose.prod.yml** avec des configurations optimisÃ©es
2. **Variables d'environnement** pour la production
3. **Configuration Nginx** pour les performances
4. **Configuration PHP** (dÃ©sactiver les erreurs, optimiser OPcache)

## ğŸ“ Notes

- Les donnÃ©es MySQL sont persistÃ©es dans un volume Docker
- Les logs sont disponibles via `docker-compose logs`
- Le hot reload est activÃ© pour le dÃ©veloppement
- phpMyAdmin est accessible pour la gestion de la DB

---

**Rakotondrasoa Zo ğŸ‰**